'use strict'

const CryptoJS = require('crypto-js')
const Buffer = require('@rr/buffer').Buffer
var bs58checkBase = require('./base')

// SHA256(SHA256(buffer))
function sha256x2 (buffer) {
  return Buffer.from(CryptoJS.SHA256(CryptoJS.SHA256(CryptoJS.enc.Hex.parse(buffer.toString('hex')))).toString(), 'hex')
}

module.exports = bs58checkBase(sha256x2)
